<?xml version="1.0" encoding="UTF-8"?>

<mule xmlns:snowflake="http://www.mulesoft.org/schema/mule/snowflake" xmlns:ee="http://www.mulesoft.org/schema/mule/ee/core"
	xmlns:db="http://www.mulesoft.org/schema/mule/db"
	xmlns="http://www.mulesoft.org/schema/mule/core" xmlns:doc="http://www.mulesoft.org/schema/mule/documentation" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.mulesoft.org/schema/mule/core http://www.mulesoft.org/schema/mule/core/current/mule.xsd
http://www.mulesoft.org/schema/mule/db http://www.mulesoft.org/schema/mule/db/current/mule-db.xsd
http://www.mulesoft.org/schema/mule/ee/core http://www.mulesoft.org/schema/mule/ee/core/current/mule-ee.xsd
http://www.mulesoft.org/schema/mule/snowflake http://www.mulesoft.org/schema/mule/snowflake/current/mule-snowflake.xsd">
<!-- [STUDIO:"sandbox-demoFlow"]	<flow name="sandbox-demoFlow" doc:id="ecaa91e7-9c78-4cb9-9ccf-f9e6563e8ca6" >
		<scheduler doc:name="Scheduler" doc:id="f5e690c6-6f77-4063-9aad-d24e252a9caf" >
			<scheduling-strategy >
				<fixed-frequency frequency="1" timeUnit="HOURS"/>
			</scheduling-strategy>
		</scheduler>
		<logger level="INFO" doc:name="Logger" doc:id="39a25814-0990-43ff-be2f-cf56841704bd" message="Starting Flow"/>
		<db:select doc:name="Select" doc:id="74414dcb-8f29-41d7-9c77-b68f021b4e4a" config-ref="crompco_sales_source">
			<db:sql ><![CDATA[SELECT * FROM service.invoice&#93;&#93;></db:sql>
		</db:select>
		<ee:transform doc:name="Transform Message" doc:id="2cacf2ab-e97b-4d2a-a84e-9dbb73f5f869" >
			<ee:message >
				<ee:set-payload ><![CDATA[%dw 2.0
output application/java
&#45;&#45;-
[payload&#93;&#93;&#93;></ee:set-payload>
			</ee:message>
		</ee:transform>
		<snowflake:bulk-insert doc:name="Bulk insert" doc:id="80c946ff-7b28-4e03-a99e-29932181c9c0" config-ref="crompco_snowflake">
			<snowflake:sql ><![CDATA[INSERT INTO CROMPCO_DEV.CROMPCO_STAGE.STSAL_INVOICE(invoice_id,entity_id,invoice_number,customer_work_number,invoice_notes,invoice_template_id,customer_contact_id,location_id,file_id,invoice_date,invoice_total,invoice_sub_total,sales_tax,published,closed,create_by,created_at,updated_at,deleted_at)
VALUES(:invoice_id, :entity_id, :invoice_number, :customer_work_number, :invoice_notes, :invoice_template_id, :customer_contact_id, :location_id, :file_id, :invoice_date, :invoice_total, :invoice_sub_total, :sales_tax, :published, :closed, :create_by, :created_at, :updated_at, :deleted_at)&#93;&#93;></snowflake:sql>
		</snowflake:bulk-insert>
		<logger level="INFO" doc:name="Logger" doc:id="abf4b0b1-e4d7-4ebc-99eb-ced75de44f75" message="#[payload&#93;"/>
		<logger level="INFO" doc:name="Logger" doc:id="da5d4b8d-4fa0-47df-a01b-1156b92fee35" message="Completed Successfully"/>
	</flow> [STUDIO] -->
	<flow name="FINANCIAL-LARSON-OWL-GL00105" doc:id="1e6ce7d2-e147-416d-9ae2-be05d464195f" >
		<scheduler doc:name="Daily" doc:id="4614633f-dbaf-450c-b1e7-d80442db0d7e" >
			<scheduling-strategy >
				<fixed-frequency timeUnit="MINUTES" />
			</scheduling-strategy>
		</scheduler>
		<try doc:name="Try" doc:id="4eb97f5c-2f61-4630-b707-95e31df4d53d" >
			<db:select doc:name="Larson_Source" doc:id="7ddea1bf-1e83-46fd-92f2-462a945553f1" config-ref="larson_source" >
				<db:sql ><![CDATA[select ACTINDX, ACTNUMBR_1, ACTNUMBR_2, ACTNUMBR_3, ACTNUMBR_4, ACTNUMST, DEX_ROW_ID from [OWL].[dbo].[GL00105];]]></db:sql>
			</db:select>
			<ee:transform doc:name="Source to Stage Conversion" doc:id="a31dd518-bae7-4add-a694-1d1e11beec76" >
				<ee:message >
					<ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
payload]]></ee:set-payload>
				</ee:message>
			</ee:transform>
			<snowflake:bulk-insert doc:name="Loading Data from Source to Stage" doc:id="185a1517-20d3-403d-89d2-6bb717ec3210" config-ref="larson_snowflake" >
				<snowflake:sql ><![CDATA[insert into STGFIN_LARSON_GL00105 (ACTINDX, ACTNUMBR_1, ACTNUMBR_2, ACTNUMBR_3, ACTNUMBR_4, ACTNUMST, DEX_ROW_ID)
VALUES(:ACTINDX, :ACTNUMBR_1, :ACTNUMBR_2, :ACTNUMBR_3, :ACTNUMBR_4, :ACTNUMST, :DEX_ROW_ID)]]></snowflake:sql>
			</snowflake:bulk-insert>
			<ee:transform doc:name="Stage to Raw Conversion" doc:id="f6b0aab9-90cb-492a-b24e-bfe4322b3044" >
				<ee:message >
					<ee:set-payload ><![CDATA[%dw 2.0
output application/json
---
payload]]></ee:set-payload>
				</ee:message>
			</ee:transform>
			<snowflake:execute-script doc:name="Truncate and Load LARSON_GL00105 to Raw" doc:id="ac365cf7-9f1d-4a4e-8af7-e8bf1f9076c1" config-ref="larson_snowflake" file="sql/Larson_LARSONGL00105.sql" />
			<error-handler >
				<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="628a75db-f03b-44df-bfe9-30690643a348" >
					<logger level="ERROR" doc:name="Error message" doc:id="d6f5eeba-9863-4ec9-9bc5-ef9ba7b0f069" message="FINANCIAL-LARSON-OWL-GL00105 has an Error" />
				</on-error-propagate>
			</error-handler>
			<logger level="INFO" doc:name="Load Success Message" doc:id="19c4c1c1-50c3-4bca-b2e3-8977d7ca906d" message="FINANCIAL-LARSON-OWL-GL00105 Loaded Successfully" />
		</try>
	</flow>
<!-- [STUDIO:"FINANCIAL-LARSON-OWL-SY40100"]	<flow name="FINANCIAL-LARSON-OWL-SY40100" doc:id="68e7b1a9-c81c-486c-9055-3067631917c5" >
		<scheduler doc:name="Daily" doc:id="a9fe4479-d58a-44ae-b322-753206e5bfee" >
			<scheduling-strategy >
				<fixed-frequency timeUnit="MINUTES" />
			</scheduling-strategy>
		</scheduler>
		<try doc:name="Try" doc:id="9c83135e-1a12-4f51-b6b8-4398f347b2b9" >
			<db:select doc:name="Larson_Source" doc:id="8512f8d7-ab64-4752-aaa7-b09e4eb0147b" config-ref="larson_source" >
				<db:sql ><![CDATA[select * from [OWL&#93;.[dbo&#93;.[SY40100&#93;;&#93;&#93;></db:sql>
			</db:select>
			<ee:transform doc:name="Source to Stage Conversion" doc:id="629f616f-fe76-4a70-846a-661e3b783a39" >
				<ee:message >
					<ee:set-payload ><![CDATA[%dw 2.0
output application/json
&#45;&#45;-
payload&#93;&#93;></ee:set-payload>
				</ee:message>
			</ee:transform>
			<snowflake:bulk-insert doc:name="Loading Data from Source to Stage" doc:id="3dc0a5e8-7222-4195-95a4-e233191eea90" config-ref="larson_snowflake" >
				<snowflake:sql ><![CDATA[insert into STGFIN_LARSON_SY40100 (CLOSED, SERIES, ODESCTN, FORIGIN, PERIODID, PERIODDT, PERNAME, PSERIES_1, PSERIES_2, PSERIES_3,
                     PSERIES_4, PSERIES_5, PSERIES_6, YEAR1, PERDENDT, DEX_ROW_TS, DEX_ROW_ID)
VALUES(:CLOSED, :SERIES, :ODESCTN, :FORIGIN, :PERIODID, :PERIODDT, :PERNAME, :PSERIES_1, :PSERIES_2, :PSERIES_3,
                     :PSERIES_4, :PSERIES_5, :PSERIES_6, :YEAR1, :PERDENDT, :DEX_ROW_TS, :DEX_ROW_ID)&#93;&#93;></snowflake:sql>
			</snowflake:bulk-insert>
			<ee:transform doc:name="Stage to Raw Conversion" doc:id="b3002a71-b1ed-4311-898c-03f3a8435d22" >
				<ee:message >
					<ee:set-payload ><![CDATA[%dw 2.0
output application/json
&#45;&#45;-
payload&#93;&#93;></ee:set-payload>
				</ee:message>
			</ee:transform>
			<snowflake:execute-script doc:name="Truncate and Load LARSON_SY40100 to Raw" doc:id="cf606621-ca9d-450a-9866-f6eb7f45ae26" config-ref="larson_snowflake" file="sql/Larson_LARSONSY40100.sql" />
			<logger level="INFO" doc:name="Load Success Message" doc:id="861843d3-039e-46fc-8eac-3926146d1ace" message="FINANCIAL-LARSON-OWL-SY40100 Loaded Successfully" />
			<error-handler >
				<on-error-propagate enableNotifications="true" logException="true" doc:name="On Error Propagate" doc:id="94e9840c-74cb-4763-80d6-304fd241f367" >
					<logger level="ERROR" doc:name="Error message" doc:id="4faafad6-80d7-4957-95e5-cb1c0170654e" message="FINANCIAL-LARSON-OWL-SY40100 has an Error" />
				</on-error-propagate>
			</error-handler>
		</try>
	</flow> [STUDIO] -->
</mule>
